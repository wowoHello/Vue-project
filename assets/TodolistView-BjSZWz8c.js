import{r as p,u as M,h as P,f as d,i as v,c as u,a as t,t as c,j as l,w as g,v as V,n as $,k as T,F as b,l as w,o as r}from"./index-aAyVGMjH.js";const j={id:"todoListPage",class:"bg-half"},E={class:"todo_sm"},F={href:"#"},I={class:"conatiner todoListPage vhContainer"},R={class:"todoList_Content"},U={class:"inputBox"},q={class:"todoList_list"},G={class:"todoList_tab"},H={class:"todoList_items"},J={class:"todoList_item"},K={class:"todoList_label"},Q=["checked","onChange"],W=["onClick"],X={class:"todoList_statistics"},Y={class:"todoList_items"},Z={class:"todoList_item"},tt={class:"todoList_label"},et=["checked","onChange"],st=["onClick"],at={class:"todoList_statistics"},ot={class:"todoList_items"},nt={class:"todoList_item"},lt={class:"todoList_label"},it=["checked","onChange"],ut=["onClick"],ct={class:"todoList_statistics"},h="https://todolist-api.hexschool.io",vt={__name:"TodolistView",setup(rt){const o=p(""),x=M(),f=p({status:"",exp:"",token:"",nickname:""});P(async()=>{const s=document.cookie.replace(/(?:(?:^|.*;\s*)customTodoName\s*\=\s*([^;]*).*$)|^.*$/,"$1");await d.get(`${h}/users/checkout`,{headers:{Authorization:s}}).then(e=>{f.value=e.data,o.value=s,y()}).catch(function(e){o.value="",alert("請重新登入："+e.message),setTimeout(()=>{x.push("/login")},1500)})});const A=async()=>{try{const s=await d.post(`${h}/users/sign_out`,{},{headers:{Authorization:o.value}});f.value={},o.value="",alert("登出成功！"),setTimeout(()=>{x.push("/login")},1e3)}catch(s){alert("登出失敗："+s.message)}},i=p("1"),m=s=>{i.value=s},n=p([]),k=p(""),y=async()=>{try{const s=await d.get(`${h}/todos/`,{headers:{Authorization:o.value}});n.value=s.data.data}catch(s){alert("資料取得失敗："+s.message)}},O=async()=>{const s={content:k.value};try{const e=await d.post(`${h}/todos/`,s,{headers:{Authorization:o.value}});alert("新增成功！"),k.value="",y()}catch(e){alert("新增失敗："+e.message)}},B=v(()=>n.value);v(()=>n.value.length);const D=v(()=>n.value.filter(s=>s.status===!1)),z=v(()=>n.value.filter(s=>s.status===!1).length),N=v(()=>n.value.filter(s=>s.status===!0)),S=v(()=>n.value.filter(s=>s.status===!0).length),L=async s=>{try{const e=await d.patch(`${h}/todos/${s}/toggle`,{},{headers:{Authorization:o.value}});y()}catch(e){alert("狀態更新失敗："+e.message)}},C=async s=>{try{await d.delete(`${h}/todos/${s}`,{headers:{Authorization:o.value}}),n.value.splice(s,1),alert("刪除成功！")}catch(e){alert("刪除失敗："+e.message)}};return(s,e)=>(r(),u("div",j,[t("nav",null,[e[4]||(e[4]=t("h1",null,[t("a",{href:"#"},"ONLINE TODO LIST")],-1)),t("ul",null,[t("li",E,[t("a",F,[t("span",null,c(f.value.nickname)+"的代辦事項",1)])]),t("li",null,[t("a",{href:"#loginPage",onClick:l(A,["prevent"])},"登出")])])]),t("div",I,[t("div",R,[t("div",U,[g(t("input",{type:"text",placeholder:"請輸入待辦事項","onUpdate:modelValue":e[0]||(e[0]=a=>k.value=a)},null,512),[[V,k.value]]),t("a",{href:"#",onClick:l(O,["prevent"])},e[5]||(e[5]=[t("i",{class:"fa fa-plus"},null,-1)]))]),t("div",q,[t("ul",G,[t("li",null,[t("a",{href:"#",class:$(i.value==="1"?"active":""),onClick:e[1]||(e[1]=l(a=>m("1"),["prevent"]))},"全部",2)]),t("li",null,[t("a",{href:"#",class:$(i.value==="2"?"active":""),onClick:e[2]||(e[2]=l(a=>m("2"),["prevent"]))},"待完成",2)]),t("li",null,[t("a",{href:"#",class:$(i.value==="3"?"active":""),onClick:e[3]||(e[3]=l(a=>m("3"),["prevent"]))},"已完成",2)])]),g(t("div",H,[t("ul",J,[(r(!0),u(b,null,w(B.value,a=>(r(),u("li",{key:a.id},[t("label",K,[t("input",{class:"todoList_input",type:"checkbox",value:"true",checked:a.status,onChange:_=>L(a.id)},null,40,Q),t("span",null,c(a.content),1)]),t("a",{href:"#",onClick:l(_=>C(a.id),["prevent"])},e[6]||(e[6]=[t("i",{class:"fa fa-times"},null,-1)]),8,W)]))),128))]),t("div",X,[t("p",null,c(z.value)+" 個待完成項目",1)])],512),[[T,i.value==="1"]]),g(t("div",Y,[t("ul",Z,[(r(!0),u(b,null,w(D.value,a=>(r(),u("li",{key:a.id},[t("label",tt,[t("input",{class:"todoList_input",type:"checkbox",value:"true",checked:a.status,onChange:_=>L(a.id)},null,40,et),t("span",null,c(a.content),1)]),t("a",{href:"#",onClick:l(_=>C(a.id),["prevent"])},e[7]||(e[7]=[t("i",{class:"fa fa-times"},null,-1)]),8,st)]))),128))]),t("div",at,[t("p",null,c(z.value)+" 個待完成項目",1)])],512),[[T,i.value==="2"]]),g(t("div",ot,[t("ul",nt,[(r(!0),u(b,null,w(N.value,a=>(r(),u("li",{key:a.id},[t("label",lt,[t("input",{class:"todoList_input",type:"checkbox",value:"true",checked:a.status,onChange:_=>L(a.id)},null,40,it),t("span",null,c(a.content),1)]),t("a",{href:"#",onClick:l(_=>C(a.id),["prevent"])},e[8]||(e[8]=[t("i",{class:"fa fa-times"},null,-1)]),8,ut)]))),128))]),t("div",ct,[t("p",null,c(S.value)+" 個已完成項目",1)])],512),[[T,i.value==="3"]])])])])]))}};export{vt as default};
